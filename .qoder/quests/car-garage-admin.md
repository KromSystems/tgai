# –°–∏—Å—Ç–µ–º–∞ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ì–∞—Ä–∞–∂–∞ - –î–∏–∑–∞–π–Ω –î–æ–∫—É–º–µ–Ω—Ç

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–∞—Ä–∞–∂–æ–º –≤ Telegram –±–æ—Ç–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —É–¥–æ–±–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏ –∏ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —á–µ—Ä–µ–∑ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é.

### –¢–µ–∫—É—â–µ–µ –°–æ—Å—Ç–æ—è–Ω–∏–µ –°–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:
- –ö–æ–º–∞–Ω–¥—É `/takecar` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- 20 –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏
- –°–∏—Å—Ç–µ–º—É –∑–∞—è–≤–æ–∫ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
- –ë–∞–∑–æ–≤—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –¶–µ–ª—å –ü—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å —É–¥–æ–±–Ω—É—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏ –≤ –≥–∞—Ä–∞–∂–µ, –≤–∫–ª—é—á–∞—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∞—à–∏–Ω –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –î–∏–∞–≥—Ä–∞–º–º–∞

```mermaid
graph TB
    A[Admin User] --> B[CarManager Component]
    B --> C[Garage Model]
    B --> D[AdminNotifier Component]
    
    C --> E[SQLite Database]
    E --> F[garage table]
    
    G[Regular User] --> H[GarageManager Component]
    H --> C
    H --> I[GarageRequest Model]
    
    I --> E
    E --> J[garage_requests table]
    
    style B fill:#FFE5B4
    style H fill:#B4D6FF
    style C fill:#D4E5FF
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –î–∞–Ω–Ω—ã—Ö

```mermaid
erDiagram
    GARAGE {
        integer car_id PK
        string car_name
        string status
        datetime last_maintenance
        datetime created_at
        datetime updated_at
    }
    
    GARAGE_REQUESTS {
        integer id PK
        integer car_id FK
        integer user_id FK
        string telegram_id
        string photo_path
        string payment_status
        datetime submitted_at
        datetime processed_at
    }
    
    USERS {
        integer id PK
        bigint telegram_id
        string username
        string first_name
        string last_name
        integer authorized
    }
    
    GARAGE ||--o{ GARAGE_REQUESTS : "has requests"
    USERS ||--o{ GARAGE_REQUESTS : "submits"
```

## –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –§—É–Ω–∫—Ü–∏–∏

### –ö–æ–º–∞–Ω–¥–∞ /garage_admin

–ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º:

```mermaid
flowchart TD
    A[/garage_admin] --> B{–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞}
    B -->|–î–∞| C[–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –≥–∞—Ä–∞–∂–∞]
    B -->|–ù–µ—Ç| D[–û—Ç–∫–∞–∑ –≤ –¥–æ—Å—Ç—É–ø–µ]
    
    C --> E[üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
    C --> F[üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏]
    C --> G[‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å]
    C --> H[üìã –ó–∞—è–≤–∫–∏ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ]
    
    F --> I[–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π]
    I --> J[–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å]
    I --> K[–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ]
    I --> L[–£–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å]
    
    G --> M[–í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –º–∞—à–∏–Ω—ã]
    M --> N[–í—ã–±–æ—Ä –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞]
    N --> O[–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è]
    
    style C fill:#E8F5E8
    style F fill:#FFE5B4
    style G fill:#E5F5FF
```

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

```
üîß –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ –ì–ê–†–ê–ñ–ê

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 20 –º–∞—à–∏–Ω
üü¢ –•–æ—Ä–æ—à–µ–µ: 8 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
üü° –°—Ä–µ–¥–Ω–µ–µ: 7 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π  
üî¥ –ü–ª–æ—Ö–æ–µ: 5 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π

[üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞] [üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ]
[‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ] [üìã –ó–∞—è–≤–∫–∏ (3)]
[üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é]
```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ê–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏

```
üîß –£–ü–†–ê–í–õ–ï–ù–ò–ï –ê–í–¢–û–ú–û–ë–ò–õ–Ø–ú–ò (–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1/4)

1. üü¢ Infernus: –•–æ—Ä–æ—à–µ–µ
2. üü° Cheetah: –°—Ä–µ–¥–Ω–µ–µ
3. üî¥ Banshee: –ü–ª–æ—Ö–æ–µ
4. üü¢ Bullet: –•–æ—Ä–æ—à–µ–µ
5. üü° Turismo: –°—Ä–µ–¥–Ω–µ–µ

[‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å] [‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å]
[‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å] [‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å]
[‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å]

[‚¨ÖÔ∏è –ù–∞–∑–∞–¥] [‚û°Ô∏è –î–∞–ª–µ–µ]
[‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ] [üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é]
```

## –ú–æ–¥–µ–ª–∏ –î–∞–Ω–Ω—ã—Ö

### –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ú–æ–¥–µ–ª—å Garage

–ö–ª–∞—Å—Å —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã:

| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-------|----------|---------------|
| `getAllCars()` | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ | –°–ø–∏—Å–æ–∫ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `updateStatus(carId, status)` | –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å | –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è |
| `getStatistics()` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å |
| `getCarsPaginated(page, size)` | –ü–∞–≥–∏–Ω–∞—Ü–∏—è | –£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è |

### –ù–æ–≤—ã–µ –ú–µ—Ç–æ–¥—ã –¥–ª—è CarManager

```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
static async addCar(carName, status = '–•–æ—Ä–æ—à–µ–µ')

// –£–¥–∞–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
static async deleteCar(carId)

// –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
static async bulkUpdateStatus(updates)

// –ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π ID
static async getNextCarId()
```

## –°–æ—Å—Ç–æ—è–Ω–∏—è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –î–∏–∞–≥—Ä–∞–º–º–∞ –°–æ—Å—Ç–æ—è–Ω–∏–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```mermaid
stateDiagram-v2
    [*] --> AdminMenu
    
    AdminMenu --> Statistics : –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    AdminMenu --> CarManagement : –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ
    AdminMenu --> AddCar : –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ
    AdminMenu --> RequestsReview : –ó–∞—è–≤–∫–∏
    
    Statistics --> AdminMenu : –ù–∞–∑–∞–¥
    
    CarManagement --> CarEdit : –í—ã–±–æ—Ä –∞–≤—Ç–æ
    CarManagement --> AdminMenu : –ù–∞–∑–∞–¥
    
    CarEdit --> StatusChange : –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å
    CarEdit --> NameChange : –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ
    CarEdit --> DeleteCar : –£–¥–∞–ª–∏—Ç—å
    CarEdit --> CarManagement : –ù–∞–∑–∞–¥
    
    StatusChange --> CarEdit : –ü—Ä–∏–º–µ–Ω–∏—Ç—å
    NameChange --> CarEdit : –ü—Ä–∏–º–µ–Ω–∏—Ç—å
    DeleteCar --> CarManagement : –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
    
    AddCar --> AwaitingName : –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è
    AwaitingName --> StatusSelection : –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ
    StatusSelection --> AdminMenu : –ê–≤—Ç–æ–º–æ–±–∏–ª—å –¥–æ–±–∞–≤–ª–µ–Ω
    
    RequestsReview --> AdminMenu : –ù–∞–∑–∞–¥
```

## –õ–æ–≥–∏–∫–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ê–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏

### –ü—Ä–æ—Ü–µ—Å—Å –î–æ–±–∞–≤–ª–µ–Ω–∏—è –ê–≤—Ç–æ–º–æ–±–∏–ª—è

```mermaid
sequenceDiagram
    participant A as –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
    participant C as CarManager
    participant G as Garage Model
    participant DB as Database
    
    A->>C: –ö–æ–º–∞–Ω–¥–∞ "–î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ"
    C->>A: –ó–∞–ø—Ä–æ—Å –Ω–∞–∑–≤–∞–Ω–∏—è –º–∞—à–∏–Ω—ã
    A->>C: –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏—è
    C->>A: –í—ã–±–æ—Ä –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
    A->>C: –í—ã–±–æ—Ä —Å—Ç–∞—Ç—É—Å–∞
    C->>G: getNextCarId()
    G->>DB: SELECT MAX(car_id)
    DB->>G: –í–æ–∑–≤—Ä–∞—Ç ID
    G->>C: nextId
    C->>G: addCar(name, status)
    G->>DB: INSERT INTO garage
    DB->>G: –£—Å–ø–µ—Ö
    G->>C: –ù–æ–≤—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å
    C->>A: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
```

### –ü—Ä–æ—Ü–µ—Å—Å –ò–∑–º–µ–Ω–µ–Ω–∏—è –°—Ç–∞—Ç—É—Å–∞

```mermaid
sequenceDiagram
    participant A as –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
    participant C as CarManager  
    participant G as Garage Model
    participant DB as Database
    
    A->>C: –í—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    C->>G: findById(carId)
    G->>DB: SELECT * FROM garage WHERE car_id = ?
    DB->>G: –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
    G->>C: –û–±—ä–µ–∫—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—è
    C->>A: –ú–µ–Ω—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    A->>C: –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å
    C->>A: –í—ã–±–æ—Ä –Ω–æ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
    A->>C: –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
    C->>G: updateStatus(carId, newStatus)
    G->>DB: UPDATE garage SET status = ?
    DB->>G: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    G->>C: –£—Å–ø–µ—Ö
    C->>A: –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç CarManager

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ö–ª–∞—Å—Å–∞

```javascript
class CarManager {
    constructor(bot, adminId)
    
    // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
    async handleGarageAdminCommand(msg)
    async showAdminMenu(chatId)
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏
    async showCarManagement(chatId, page = 0)
    async handleCarEdit(callbackQuery)
    async handleStatusChange(callbackQuery)
    async handleNameChange(callbackQuery)
    async handleDeleteCar(callbackQuery)
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
    async handleAddCar(callbackQuery)
    async processNewCarName(msg)
    async processCarStatus(callbackQuery)
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∑–∞—è–≤–∫–∏
    async showStatistics(chatId)
    async showRequests(chatId)
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
    buildAdminKeyboard()
    buildCarManagementKeyboard(cars, pagination)
    buildStatusKeyboard(carId)
    setAdminSession(telegramId, sessionData)
    getAdminSession(telegramId)
}
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –°–µ—Å—Å–∏–π

```javascript
ADMIN_STATES = {
    AWAITING_CAR_NAME: 'admin_awaiting_car_name',
    AWAITING_NEW_CAR_NAME: 'admin_awaiting_new_car_name',
    CONFIRMING_DELETE: 'admin_confirming_delete'
}
```

## –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ì–ª–∞–≤–Ω–∞—è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞

```javascript
[
    [
        { text: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞', callback_data: 'admin_stats' },
        { text: 'üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', callback_data: 'admin_manage' }
    ],
    [
        { text: '‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ', callback_data: 'admin_add_car' },
        { text: 'üìã –ó–∞—è–≤–∫–∏', callback_data: 'admin_requests' }
    ],
    [
        { text: 'üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', callback_data: 'back_to_main' }
    ]
]
```

### –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ê–≤—Ç–æ–º–æ–±–∏–ª–µ–º

```javascript
[
    [
        { text: 'üé® –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å', callback_data: `admin_status_${carId}` },
        { text: '‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ', callback_data: `admin_name_${carId}` }
    ],
    [
        { text: 'üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ', callback_data: `admin_delete_${carId}` }
    ],
    [
        { text: '‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É', callback_data: 'admin_manage' }
    ]
]
```

### –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –í—ã–±–æ—Ä–∞ –°—Ç–∞—Ç—É—Å–∞

```javascript
[
    [
        { text: 'üü¢ –•–æ—Ä–æ—à–µ–µ', callback_data: `admin_set_status_${carId}_–•–æ—Ä–æ—à–µ–µ` }
    ],
    [
        { text: 'üü° –°—Ä–µ–¥–Ω–µ–µ', callback_data: `admin_set_status_${carId}_–°—Ä–µ–¥–Ω–µ–µ` }
    ],
    [
        { text: 'üî¥ –ü–ª–æ—Ö–æ–µ', callback_data: `admin_set_status_${carId}_–ü–ª–æ—Ö–æ–µ` }
    ],
    [
        { text: '‚ùå –û—Ç–º–µ–Ω–∞', callback_data: `admin_edit_${carId}` }
    ]
]
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –°—É—â–µ—Å—Ç–≤—É—é—â–µ–π –°–∏—Å—Ç–µ–º–æ–π

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ app.js

```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
const CarManager = require('./components/CarManager');

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
const carManager = new CarManager(bot, process.env.ADMIN_ID);

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
bot.onText(/\/garage_admin/, (msg) => {
    carManager.handleGarageAdminCommand(msg);
});

// Callback query –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
bot.on('callback_query', (callbackQuery) => {
    if (callbackQuery.data.startsWith('admin_')) {
        carManager.handleAdminCallback(callbackQuery);
    }
});
```

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ú–æ–¥–µ–ª–∏ Garage

```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
static async addCar(carName, status = '–•–æ—Ä–æ—à–µ–µ') {
    const nextId = await this.getNextCarId();
    const sql = `
        INSERT INTO garage (car_id, car_name, status, last_maintenance) 
        VALUES (?, ?, ?, CURRENT_TIMESTAMP)
    `;
    
    try {
        await database.run(sql, [nextId, carName, status]);
        return await this.findById(nextId);
    } catch (error) {
        throw new Error(`–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è: ${error.message}`);
    }
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ ID
static async getNextCarId() {
    const sql = 'SELECT MAX(car_id) as maxId FROM garage';
    try {
        const result = await database.get(sql);
        return (result.maxId || 0) + 1;
    } catch (error) {
        throw new Error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ ID: ${error.message}`);
    }
}

// –£–¥–∞–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
static async deleteCar(carId) {
    const sql = 'DELETE FROM garage WHERE car_id = ?';
    try {
        const result = await database.run(sql, [carId]);
        if (result.changes === 0) {
            throw new Error(`–ê–≤—Ç–æ–º–æ–±–∏–ª—å —Å ID ${carId} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
        }
        return true;
    } catch (error) {
        throw new Error(`–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è: ${error.message}`);
    }
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –í–∞–ª–∏–¥–∞—Ü–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ü—Ä–∞–≤ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```javascript
async isAdmin(telegramId) {
    const adminIds = process.env.ADMIN_IDS.split(',').map(id => parseInt(id));
    return adminIds.includes(telegramId);
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –î–∞–Ω–Ω—ã—Ö

```javascript
validateCarName(name) {
    if (!name || name.trim().length === 0) {
        throw new Error('–ù–∞–∑–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º');
    }
    
    if (name.length > 50) {
        throw new Error('–ù–∞–∑–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ (–º–∞–∫—Å–∏–º—É–º 50 —Å–∏–º–≤–æ–ª–æ–≤)');
    }
    
    return name.trim();
}

validateStatus(status) {
    const validStatuses = ['–•–æ—Ä–æ—à–µ–µ', '–°—Ä–µ–¥–Ω–µ–µ', '–ü–ª–æ—Ö–æ–µ'];
    if (!validStatuses.includes(status)) {
        throw new Error(`–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å—Ç–∞—Ç—É—Å: ${status}`);
    }
    return status;
}
```

## –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

### –°–æ–æ–±—â–µ–Ω–∏—è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```javascript
ADMIN_MESSAGES = {
    ACCESS_DENIED: '‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω! –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.',
    MAIN_MENU: 'üîß –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ –ì–ê–†–ê–ñ–ê',
    CAR_ADDED: '‚úÖ –ê–≤—Ç–æ–º–æ–±–∏–ª—å "{name}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!',
    CAR_DELETED: 'üóëÔ∏è –ê–≤—Ç–æ–º–æ–±–∏–ª—å "{name}" —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!',
    STATUS_UPDATED: '‚úÖ –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è "{name}" –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ {status}',
    NAME_UPDATED: '‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ "{name}"',
    ENTER_CAR_NAME: 'üìù –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è:',
    SELECT_STATUS: 'üé® –í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è:',
    CONFIRM_DELETE: '‚ö†Ô∏è –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å "{name}"?'
};
```